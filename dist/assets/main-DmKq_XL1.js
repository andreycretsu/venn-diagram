var e=Object.defineProperty,t=(t,i,s)=>((t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s)(t,"symbol"!=typeof i?i+"":i,s);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class i{constructor(e,t={}){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.config={cardSize:80,borderRadius:12,exportScale:2,...t},this.isDragging=!1,this.dragOffset={x:0,y:0},this.selectedCards=[],this.hoveredCard=null,this.init()}init(){this.resizeCanvas(),this.setupEventListeners()}resizeCanvas(){const e=this.canvas.getBoundingClientRect(),t=window.devicePixelRatio||1;this.canvas.width=e.width*t,this.canvas.height=e.height*t,this.ctx.scale(t,t),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px"}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("click",this.handleClick.bind(this)),this.canvas.addEventListener("contextmenu",this.handleContextMenu.bind(this)),window.addEventListener("resize",this.handleResize.bind(this))}handleMouseDown(e){const t=this.canvas.getBoundingClientRect(),i=e.clientX-t.left,s=e.clientY-t.top,a=this.getCardAt(i,s);a&&(this.isDragging=!0,this.dragOffset={x:i-a.x,y:s-a.y},this.selectedCards.includes(a)||(e.ctrlKey||e.metaKey||(this.selectedCards=[]),this.selectedCards.push(a)))}handleMouseMove(e){if(!this.isDragging)return;const t=this.canvas.getBoundingClientRect(),i=e.clientX-t.left,s=e.clientY-t.top;this.selectedCards.forEach((e=>{e.x=i-this.dragOffset.x,e.y=s-this.dragOffset.y})),this.render()}handleMouseUp(){this.isDragging=!1}handleClick(e){if(this.isDragging)return;const t=this.canvas.getBoundingClientRect(),i=e.clientX-t.left,s=e.clientY-t.top;this.emit("canvasClick",{x:i,y:s})}handleContextMenu(e){e.preventDefault();const t=this.canvas.getBoundingClientRect(),i=e.clientX-t.left,s=e.clientY-t.top,a=this.getCardAt(i,s);a&&this.emit("cardContextMenu",{card:a,x:e.clientX,y:e.clientY})}handleResize(){setTimeout((()=>{this.resizeCanvas(),this.render()}),0)}getCardAt(e,t){const i=this.config.cardSize/2;for(let s=this.cards.length-1;s>=0;s--){const a=this.cards[s];if(e>=a.x-i&&e<=a.x+i&&t>=a.y-i&&t<=a.y+i)return a}return null}drawCard(e){const{cardSize:t}=this.config,i=Math.max(4,.15*t),s=e.x-t/2,a=e.y-t/2,o=this.selectedCards.includes(e),n=this.hoveredCard===e;this.ctx.save(),this.drawCardShadow(e,o,n),this.drawCardBackground(e,s,a,t,i),this.drawCardBorder(e,s,a,t,i,o,n),this.drawCardContent(e,t),this.drawCategoryIndicator(e,s,a,t),this.ctx.restore()}drawCardShadow(e,t,i){const s="rgba(0, 0, 0, 0.4)",a=25,o=12;let n=1;t?n=1.5:i&&(n=1.2),this.ctx.shadowColor=s,this.ctx.shadowBlur=a*n,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=o*n}drawCardBackground(e,t,i,s,a){this.ctx.beginPath(),this.roundRect(t,i,s,s,a);const o=this.ctx.createLinearGradient(t,i,t+s,i+s);o.addColorStop(0,"#1f2937"),o.addColorStop(1,"#111827"),this.ctx.fillStyle=o,this.ctx.fill(),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetY=0}drawCardBorder(e,t,i,s,a,o,n){this.ctx.strokeStyle=o?"#667eea":n?"#764ba2":"#374151",this.ctx.lineWidth=o?3:n?2.5:2,this.ctx.beginPath(),this.roundRect(t,i,s,s,a),this.ctx.stroke()}drawCardContent(e,t){e.logoUrl&&e.logoLoaded?this.drawLogo(e,t):this.drawInitials(e,t)}drawLogo(e,t){const i=.7*t,s=.15*t;this.ctx.save(),this.ctx.beginPath(),this.roundRect(e.x-t/2+s,e.y-t/2+s,t-2*s,t-2*s,8),this.ctx.clip(),this.ctx.drawImage(e.logoImage,e.x-i/2,e.y-i/2,i,i),this.ctx.restore()}drawInitials(e,t){this.ctx.fillStyle="#ffffff",this.ctx.font=`bold ${Math.max(14,.25*t)}px Inter, system-ui, sans-serif`,this.ctx.textAlign="center",this.ctx.textBaseline="middle";const i=this.getCompanyInitials(e.company);this.ctx.fillText(i,e.x,e.y)}drawCategoryIndicator(e,t,i,s){const a={technology:"#3b82f6",finance:"#10b981",healthcare:"#ef4444",education:"#8b5cf6",retail:"#f59e0b",manufacturing:"#6b7280",services:"#06b6d4",other:"#84cc16"}[e.category]||"#84cc16",o=Math.max(6,.1*s),n=t+s-12,r=i+12;this.ctx.save(),this.ctx.shadowColor="rgba(0, 0, 0, 0.2)",this.ctx.shadowBlur=4,this.ctx.shadowOffsetY=2,this.ctx.fillStyle=a,this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.arc(n,r,o,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore()}roundRect(e,t,i,s,a){this.ctx.roundRect?this.ctx.roundRect(e,t,i,s,a):(this.ctx.moveTo(e+a,t),this.ctx.lineTo(e+i-a,t),this.ctx.quadraticCurveTo(e+i,t,e+i,t+a),this.ctx.lineTo(e+i,t+s-a),this.ctx.quadraticCurveTo(e+i,t+s,e+i-a,t+s),this.ctx.lineTo(e+a,t+s),this.ctx.quadraticCurveTo(e,t+s,e,t+s-a),this.ctx.lineTo(e,t+a),this.ctx.quadraticCurveTo(e,t,e+a,t))}getCompanyInitials(e){return e.split(" ").filter((e=>e.length>0)).slice(0,2).map((e=>e[0].toUpperCase())).join("")}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight),this.showCircles&&this.drawCircles(),this.cards&&this.cards.forEach((e=>this.drawCard(e))),this.drawSelectionIndicators()}drawCircles(){const{width:e,height:t}=this.canvas,i=e/2,s=t/2,a=Math.min(e,t)/4,o=.6*a;[{x:i-o,y:s-o/2,label:"HRIS",color:"rgba(59, 130, 246, 0.1)"},{x:i+o,y:s-o/2,label:"Payroll",color:"rgba(16, 185, 129, 0.1)"},{x:i,y:s+o,label:"Expense",color:"rgba(239, 68, 68, 0.1)"}].forEach((e=>{this.ctx.save(),this.ctx.globalAlpha=.3,this.ctx.fillStyle=e.color,this.ctx.strokeStyle=e.color.replace("0.1","0.6"),this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.arc(e.x,e.y,a,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore(),this.ctx.fillStyle="#374151",this.ctx.font="bold 16px Inter, sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(e.label,e.x,e.y-a-30)}))}drawSelectionIndicators(){this.selectedCards.forEach((e=>{const{cardSize:t}=this.config,i=Math.max(6,.1*t),s=t/2;this.ctx.strokeStyle="#667eea",this.ctx.lineWidth=3,this.ctx.setLineDash([8,4]),this.ctx.beginPath(),this.roundRect(e.x-s-i,e.y-s-i,t+2*i,t+2*i,8),this.ctx.stroke(),this.ctx.setLineDash([])}))}emit(e,t){this.eventHandlers&&this.eventHandlers[e]&&this.eventHandlers[e].forEach((e=>e(t)))}on(e,t){this.eventHandlers||(this.eventHandlers={}),this.eventHandlers[e]||(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)}setCards(e){this.cards=e,this.render()}setConfig(e){this.config={...this.config,...e},this.render()}exportCanvas(){const e=document.createElement("canvas"),t=e.getContext("2d"),i=this.config.exportScale;e.width=this.canvas.clientWidth*i,e.height=this.canvas.clientHeight*i,t.scale(i,i),t.fillStyle="#ffffff",t.fillRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight);const s=this.ctx;return this.ctx=t,this.showCircles&&this.drawCircles(),this.cards&&this.cards.forEach((e=>this.drawCard(e))),this.ctx=s,e}}class s{constructor(){this.cards=[],this.cardIdCounter=1,this.logoCache=new Map,this.companyData={hris:["BambooHR","Workday","ADP","Namely","Rippling","Lattice","Culture Amp","BreatheHR","Personio","HiBob"],payroll:["Gusto","Justworks","Paychex","TriNet","Paylocity","UKG","Remote","Deel","Sage","Zenefits"],expense:["Expensify","Ramp","Brex","Pleo","Spendesk","Divvy","Concur","Coupa","Airbase","Mesh"]}}createCard(e){const t={id:this.cardIdCounter++,company:e.company,category:e.category||"technology",x:e.x||0,y:e.y||0,logoUrl:e.logoUrl||this.generateLogoUrl(e.company),logoLoaded:!1,logoImage:null,isPortfolio:e.isPortfolio||!1,created:(new Date).toISOString()};return this.cards.push(t),this.loadCardLogo(t),t}updateCard(e,t){const i=this.cards.findIndex((t=>t.id===e));return-1===i?null:(this.cards[i]={...this.cards[i],...t},this.cards[i])}deleteCard(e){const t=this.cards.findIndex((t=>t.id===e));return-1!==t&&(this.cards.splice(t,1),!0)}getAllCards(){return[...this.cards]}getCard(e){return this.cards.find((t=>t.id===e))}clearAllCards(){this.cards=[],this.cardIdCounter=1}duplicateCard(e){const t=this.getCard(e);if(!t)return null;const i={...t,id:this.cardIdCounter++,x:t.x+20,y:t.y+20,created:(new Date).toISOString()};return this.cards.push(i),i}populateWithCompanies(e,t,i){this.clearAllCards();const s=e/2,a=t/2,{radius:o,spacing:n}=i,r=n*Math.sqrt(3)/2,c={hris:{x:s,y:a-r/2},payroll:{x:s-n/2,y:a+r/2},expense:{x:s+n/2,y:a+r/2}};let d=0;return Object.entries(this.companyData).forEach((([e,t])=>{const i=c[e],s=Math.min(t.length,8);t.slice(0,s).forEach(((t,a)=>{const n=a/s*2*Math.PI,r=.6*o,c=i.x+Math.cos(n)*r,l=i.y+Math.sin(n)*r;this.createCard({company:t,category:this.getCategoryForCompany(e),x:c,y:l,isPortfolio:Math.random()>.7}),d++}))})),d}generateLogoUrl(e){const t=e.toLowerCase().replace(/\s+/g,"");return[`https://logo.clearbit.com/${t}.com`,`https://img.logo.dev/${t}.com?token=pk_X_YourTokenHere`,`https://logo.uplead.com/${t}.com`,`https://ui-avatars.com/api/?name=${encodeURIComponent(e)}&size=128&background=1f2937&color=ffffff&bold=true`][0]}async loadCardLogo(e){if(this.logoCache.has(e.company)){const t=this.logoCache.get(e.company);return e.logoImage=t,e.logoLoaded=!0,!0}const t=new Image;return t.crossOrigin="anonymous",new Promise((i=>{t.onload=()=>{e.logoImage=t,e.logoLoaded=!0,this.logoCache.set(e.company,t),i(!0)},t.onerror=()=>{this.tryLogoFallback(e,1).then(i)},t.src=e.logoUrl}))}async tryLogoFallback(e,t){const i=[null,`https://img.logo.dev/${e.company.toLowerCase().replace(/\s+/g,"")}.com?token=pk_fallback`,`https://logo.uplead.com/${e.company.toLowerCase().replace(/\s+/g,"")}.com`,`https://ui-avatars.com/api/?name=${encodeURIComponent(e.company)}&size=128&background=1f2937&color=ffffff&bold=true`];if(t>=i.length)return e.logoLoaded=!1,!1;const s=new Image;return s.crossOrigin="anonymous",new Promise((a=>{s.onload=()=>{e.logoImage=s,e.logoLoaded=!0,e.logoUrl=i[t],this.logoCache.set(e.company,s),a(!0)},s.onerror=()=>{this.tryLogoFallback(e,t+1).then(a)},s.src=i[t]}))}getCategoryForCompany(e){return{hris:"technology",payroll:"finance",expense:"finance"}[e]||"technology"}exportData(){return{cards:this.cards,cardIdCounter:this.cardIdCounter,timestamp:(new Date).toISOString()}}importData(e){return!(!e.cards||!Array.isArray(e.cards))&&(this.cards=e.cards,this.cardIdCounter=e.cardIdCounter||this.cards.length+1,this.cards.forEach((e=>{e.logoUrl&&this.loadCardLogo(e)})),!0)}searchCards(e){const t=e.toLowerCase();return this.cards.filter((e=>e.company.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)))}getCardsByCategory(e){return this.cards.filter((t=>t.category===e))}getStatistics(){const e={};return this.cards.forEach((t=>{e[t.category]=(e[t.category]||0)+1})),{totalCards:this.cards.length,categories:e,portfolioCompanies:this.cards.filter((e=>e.isPortfolio)).length,companiesWithLogos:this.cards.filter((e=>e.logoLoaded)).length}}}class a{constructor(e,t){this.cardService=e,this.canvas=t,this.clickPosition={x:0,y:0},this.contextMenuCard=null,this.config={circleRadius:180,circleSpacing:310,circleOpacity:30,cardSize:80,showCircles:!0,showGrid:!1,showGuides:!0},this.init()}init(){this.setupEventListeners(),this.setupSliders(),this.updateCanvasConfig(),this.loadFromStorage()}setupEventListeners(){this.canvas.on("canvasClick",(e=>{this.clickPosition=e,this.updatePositionDisplay()})),this.canvas.on("cardContextMenu",(e=>{this.contextMenuCard=e.card,this.showContextMenu(e.x,e.y)})),this.setupFormHandlers(),this.setupButtonHandlers(),document.addEventListener("click",(()=>this.hideContextMenu())),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupFormHandlers(){const e=document.getElementById("companyName"),t=document.getElementById("cardCategory");e&&(e.addEventListener("input",this.updatePreview.bind(this)),e.addEventListener("keypress",(e=>{"Enter"===e.key&&this.addBusinessCard()}))),t&&t.addEventListener("change",this.updatePreview.bind(this))}setupButtonHandlers(){window.openAddCardModal=()=>this.openModal("addCardModal"),window.openSettingsModal=()=>this.openModal("settingsModal"),window.exportCanvas=()=>this.exportCanvas(),window.addBusinessCard=()=>this.addBusinessCard(),window.populateCanvas=()=>this.populateCanvas(),window.clearAndPopulate=()=>this.clearAndPopulate(),window.clearAllCards=()=>this.clearAllCards(),window.selectAllCards=()=>this.selectAllCards(),window.deselectAllCards=()=>this.deselectAllCards(),window.toggleCircles=()=>this.toggleCircles(),window.toggleGrid=()=>this.toggleGrid(),window.setOptimalSpacing=()=>this.setOptimalSpacing(),window.closeModal=e=>this.closeModal(e),window.editCard=()=>this.editCard(),window.duplicateCard=()=>this.duplicateCard(),window.deleteCardFromContext=()=>this.deleteCardFromContext()}setupSliders(){[{id:"circleRadius",property:"circleRadius",suffix:"px",valueId:"radiusValue"},{id:"circleSpacing",property:"circleSpacing",suffix:"px",valueId:"spacingValue"},{id:"circleOpacity",property:"circleOpacity",suffix:"%",valueId:"opacityValue"},{id:"cardSize",property:"cardSize",suffix:"px",valueId:"cardSizeValue"}].forEach((({id:e,property:t,suffix:i,valueId:s})=>{const a=document.getElementById(e),o=document.getElementById(s);a&&o&&(a.value=this.config[t],o.textContent=this.config[t]+i,a.addEventListener("input",(()=>{this.config[t]=parseInt(a.value),o.textContent=this.config[t]+i,this.updateCanvasConfig(),this.saveToStorage()})))}))}updateCanvasConfig(){this.canvas.setConfig({cardSize:this.config.cardSize}),this.canvas.showCircles=this.config.showCircles,this.canvas.render()}openModal(e){const t=document.getElementById(e);t&&(t.classList.add("show"),"addCardModal"===e&&this.updatePreview())}closeModal(e){const t=document.getElementById(e);t&&t.classList.remove("show")}addBusinessCard(){const e=document.getElementById("companyName")?.value.trim(),t=document.getElementById("cardCategory")?.value||"technology",i=document.getElementById("logoUrl")?.value.trim();e?0!==this.clickPosition.x||0!==this.clickPosition.y?(this.cardService.createCard({company:e,category:t,x:this.clickPosition.x,y:this.clickPosition.y,logoUrl:i}),this.canvas.setCards(this.cardService.getAllCards()),this.closeModal("addCardModal"),this.showNotification(`Added ${e} to canvas`,"success"),this.saveToStorage(),document.getElementById("companyName").value="",document.getElementById("logoUrl")&&(document.getElementById("logoUrl").value="")):this.showNotification("Please click on the canvas to set a position first","warning"):this.showNotification("Please enter a company name","error")}populateCanvas(){const e=this.canvas.canvas.getBoundingClientRect(),t=this.cardService.populateWithCompanies(e.width,e.height,{radius:this.config.circleRadius,spacing:this.config.circleSpacing});this.canvas.setCards(this.cardService.getAllCards()),this.showNotification(`Added ${t} companies to canvas`,"success"),this.saveToStorage()}clearAndPopulate(){this.cardService.clearAllCards(),this.populateCanvas()}clearAllCards(){this.cardService.clearAllCards(),this.canvas.setCards([]),this.showNotification("All cards cleared","info"),this.saveToStorage()}selectAllCards(){this.canvas.selectedCards=[...this.cardService.getAllCards()],this.canvas.render()}deselectAllCards(){this.canvas.selectedCards=[],this.canvas.render()}toggleCircles(){this.config.showCircles=!this.config.showCircles,this.updateCanvasConfig(),this.saveToStorage()}toggleGrid(){this.config.showGrid=!this.config.showGrid,this.updateCanvasConfig(),this.saveToStorage()}setOptimalSpacing(){this.config.circleSpacing=310,this.config.circleRadius=180;const e=document.getElementById("circleSpacing"),t=document.getElementById("circleRadius");e&&(e.value=this.config.circleSpacing),t&&(t.value=this.config.circleRadius),this.updateSliderDisplays(),this.updateCanvasConfig(),this.saveToStorage()}updateSliderDisplays(){const e=document.getElementById("radiusValue"),t=document.getElementById("spacingValue");e&&(e.textContent=this.config.circleRadius+"px"),t&&(t.textContent=this.config.circleSpacing+"px")}showContextMenu(e,t){const i=document.getElementById("contextMenu");i&&(i.style.left=e+"px",i.style.top=t+"px",i.style.display="block")}hideContextMenu(){const e=document.getElementById("contextMenu");e&&(e.style.display="none")}editCard(){this.contextMenuCard&&this.showNotification("Edit functionality coming soon","info")}duplicateCard(){if(this.contextMenuCard){const e=this.cardService.duplicateCard(this.contextMenuCard.id);e&&(this.canvas.setCards(this.cardService.getAllCards()),this.showNotification(`Duplicated ${e.company}`,"success"),this.saveToStorage())}}deleteCardFromContext(){if(this.contextMenuCard){this.cardService.deleteCard(this.contextMenuCard.id)&&(this.canvas.setCards(this.cardService.getAllCards()),this.showNotification("Card deleted","info"),this.saveToStorage())}}exportCanvas(){this.canvas.exportCanvas().toBlob((e=>{const t=URL.createObjectURL(e),i=document.createElement("a");i.href=t;const s=(new Date).toISOString().slice(0,19).replace(/[:.]/g,"-");i.download=`business-cards-${s}@2x.png`,i.click(),URL.revokeObjectURL(t),this.showNotification("Canvas exported at 2x resolution!","success")}))}updatePositionDisplay(){const e=document.getElementById("selectedPosition");e&&(e.textContent=`${Math.round(this.clickPosition.x)}, ${Math.round(this.clickPosition.y)}`)}updatePreview(){const e=document.getElementById("companyName")?.value||"Preview",t=document.getElementById("cardCategory")?.value||"technology",i=document.getElementById("cardPreview");if(i){const s={technology:"#3b82f6",finance:"#10b981",healthcare:"#ef4444",education:"#8b5cf6",retail:"#f59e0b",manufacturing:"#6b7280",services:"#06b6d4",other:"#84cc16"},a=e.split(" ").filter((e=>e.length>0)).slice(0,2).map((e=>e[0].toUpperCase())).join("");i.innerHTML=`\n        <div class="preview-card" style="\n          background: linear-gradient(135deg, #1f2937, #111827);\n          color: #ffffff;\n          border: 2px solid #374151;\n          position: relative;\n          border-radius: 12px;\n          padding: 20px;\n          text-align: center;\n          font-weight: bold;\n        ">\n          ${a}\n          <div style="\n            position: absolute;\n            top: 4px;\n            right: 4px;\n            width: 8px;\n            height: 8px;\n            background: ${s[t]};\n            border-radius: 50%;\n            border: 1px solid white;\n          "></div>\n        </div>\n      `}}handleKeyDown(e){if("Delete"===e.key&&this.canvas.selectedCards.length>0&&(this.canvas.selectedCards.forEach((e=>{this.cardService.deleteCard(e.id)})),this.canvas.selectedCards=[],this.canvas.setCards(this.cardService.getAllCards()),this.saveToStorage()),"Escape"===e.key&&(this.deselectAllCards(),this.hideContextMenu()),e.ctrlKey||e.metaKey)switch(e.key){case"a":e.preventDefault(),this.selectAllCards();break;case"e":e.preventDefault(),this.exportCanvas()}}showNotification(e,t="info"){const i=document.createElement("div");i.className=`notification notification-${t}`,i.innerHTML=`\n      <div class="notification-content">\n        <i class="fas fa-${"success"===t?"check-circle":"error"===t?"exclamation-circle":"warning"===t?"exclamation-triangle":"info-circle"}"></i>\n        <span>${e}</span>\n      </div>\n      <button class="notification-close" onclick="this.parentElement.remove()">\n        <i class="fas fa-times"></i>\n      </button>\n    `,document.body.appendChild(i),setTimeout((()=>{i.classList.add("show")}),100),setTimeout((()=>{i.parentElement&&i.remove()}),5e3)}saveToStorage(){const e={config:this.config,cards:this.cardService.exportData(),timestamp:(new Date).toISOString()};try{localStorage.setItem("businessCardCanvas",JSON.stringify(e))}catch(t){console.error("Failed to save to localStorage:",t)}}loadFromStorage(){try{const e=localStorage.getItem("businessCardCanvas");if(e){const t=JSON.parse(e);t.config&&(this.config={...this.config,...t.config},this.updateCanvasConfig()),t.cards&&(this.cardService.importData(t.cards),this.canvas.setCards(this.cardService.getAllCards())),this.updateSliderValues()}else this.populateWithExampleCompanies()}catch(e){console.error("Failed to load from localStorage:",e)}}populateWithExampleCompanies(){[{company:"Workday",category:"technology",x:200,y:150},{company:"Gusto",category:"technology",x:400,y:150},{company:"Expensify",category:"finance",x:300,y:300},{company:"ADP",category:"technology",x:250,y:200},{company:"Concur",category:"finance",x:350,y:250}].forEach((e=>{this.cardService.createCard(e)})),this.canvas.setCards(this.cardService.getAllCards()),this.saveToStorage(),setTimeout((()=>{this.showNotification('Welcome! These are example companies. Click "Populate with Companies" for more or add your own!',"info")}),1e3)}updateSliderValues(){[{id:"circleRadius",property:"circleRadius",valueId:"radiusValue",suffix:"px"},{id:"circleSpacing",property:"circleSpacing",valueId:"spacingValue",suffix:"px"},{id:"circleOpacity",property:"circleOpacity",valueId:"opacityValue",suffix:"%"},{id:"cardSize",property:"cardSize",valueId:"cardSizeValue",suffix:"px"}].forEach((({id:e,property:t,valueId:i,suffix:s})=>{const a=document.getElementById(e),o=document.getElementById(i);a&&o&&(a.value=this.config[t],o.textContent=this.config[t]+s)}))}}const o=new class{constructor(){t(this,"dev",{addTestCards:(e=5)=>{const t=["TestCorp","DevCo","CodeInc","TechLtd","DataCorp"],i=["technology","finance","healthcare"];for(let s=0;s<e;s++)this.cardService.createCard({company:t[s%t.length]+` ${s+1}`,category:i[s%i.length],x:100+100*s,y:100+50*s});this.canvas.setCards(this.cardService.getAllCards()),console.log(`Added ${e} test cards`)},clearAll:()=>{this.cardService.clearAllCards(),this.canvas.setCards([]),console.log("Cleared all cards")},exportData:()=>{const e=this.cardService.exportData();return console.log("Export data:",e),e},importData:e=>{const t=this.cardService.importData(e);return t?(this.canvas.setCards(this.cardService.getAllCards()),console.log("Data imported successfully")):console.error("Failed to import data"),t}}),this.version="2.0.0",this.initialized=!1,console.log(`🚀 Business Card Canvas v${this.version} - Executive Edition`),this.init()}async init(){try{"loading"===document.readyState&&await new Promise((e=>{document.addEventListener("DOMContentLoaded",e)})),this.initializeComponents(),this.setupErrorHandling(),this.setupPerformanceMonitoring(),this.initialized=!0,console.log("✅ Application initialized successfully"),this.showWelcomeMessage()}catch(e){console.error("❌ Failed to initialize application:",e),this.showErrorMessage("Failed to initialize application")}}initializeComponents(){const e=document.getElementById("canvas");if(!e)throw new Error("Canvas element not found");this.cardService=new s,this.canvas=new i(e,{cardSize:80,borderRadius:12,exportScale:2}),this.uiManager=new a(this.cardService,this.canvas),this.setupComponentCommunication()}setupComponentCommunication(){this.canvas.on("cardUpdate",(()=>{this.uiManager.saveToStorage()})),this.cardService.on=this.cardService.on||(()=>{}),window.addEventListener("beforeunload",(()=>{this.uiManager.saveToStorage()}))}setupErrorHandling(){window.addEventListener("error",(e=>{console.error("Global error:",e.error),this.handleError(e.error)})),window.addEventListener("unhandledrejection",(e=>{console.error("Unhandled promise rejection:",e.reason),this.handleError(e.reason)}))}setupPerformanceMonitoring(){let e=0,t=performance.now();const i=this.canvas.render.bind(this.canvas);this.canvas.render=()=>{performance.now(),i();const s=performance.now();if(e++,e%60==0){const e=(s-t)/60;e>16.67&&console.warn(`⚠️ Rendering performance: ${e.toFixed(2)}ms avg frame time`),t=s}}}handleError(e){!["ResizeObserver loop limit exceeded","Non-Error promise rejection captured"].some((t=>e.message&&e.message.includes(t)))&&this.uiManager&&this.uiManager.showNotification("An error occurred. Please refresh the page if issues persist.","error")}showWelcomeMessage(){setTimeout((()=>{this.uiManager&&0===this.cardService.getAllCards().length&&this.uiManager.showNotification('Welcome! Click "Populate with Companies" to get started or add cards manually.',"info")}),1e3)}showErrorMessage(e){const t=document.createElement("div");t.className="error-message",t.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #ef4444;\n      color: white;\n      padding: 16px;\n      border-radius: 8px;\n      z-index: 10000;\n      font-family: system-ui, sans-serif;\n    ",t.textContent=e,document.body.appendChild(t),setTimeout((()=>{t.remove()}),5e3)}getStats(){return this.initialized?{version:this.version,cards:this.cardService.getStatistics(),canvas:{width:this.canvas.canvas.clientWidth,height:this.canvas.canvas.clientHeight,selectedCards:this.canvas.selectedCards.length},performance:{memory:performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1024/1024)+"MB",total:Math.round(performance.memory.totalJSHeapSize/1024/1024)+"MB"}:"Not available"}}:null}};"undefined"!=typeof window&&(window.businessCardApp=o);
